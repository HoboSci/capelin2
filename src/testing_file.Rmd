---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
presback <- read.csv("../output/bio/presab_nafo_yr.csv", header = TRUE)
presences <- subset(presback, occurrence == "1") #splits the testing dataset into presences
un_mth <- unique(presences$month)
prrows <- length(presences)
presences$season <- 5


for (i in 1:nrow(presences)){
  if (presences$month[i] >= 1 & presences$month[i] <= 3){
    presences$season[i] <- 1
    } else if (presences$month[i] >= 4 & presences$month[i] <= 6){
    presences$season[i] <- 2
    } else if (presences$month[i] >= 7 & presences$month[i] <= 9){
    presences$season[i] <- 3
    } else if (presences$month[i] >= 10 & presences$month[i] <= 12){
    presences$season[i] <- 4
  }
}

write.csv(presences, "../output/bio/cluster_seasons_test.csv", row.names = FALSE)

names(presences)

pres <- subset(presences, select = c(year, month, temp_depth, salinity_depth, o2_depth, chl_surface, nao_sample, nao_prev, nao_winter, amo_sample, amo_winter, season))
pres <- na.omit(pres)
pres2 <- na.omit(presences)
pres <- scale(pres)
```

```{r}

library("cluster")
library("factoextra")
library("magrittr")
```

```{r}
distance <- get_dist(pres)
fviz_dist(distance, gradient = list(low = "#00AFBB", mid = "white", high = "#FC4E07"))
```


```{r}
fviz_nbclust(pres, kmeans, method = "gap_stat")
```

```{r}
set.seed(123)
km.res <- kmeans(pres, 6, nstart = 25)
km.res
# Visualize
library("factoextra")
fviz_cluster(km.res, data = pres,
             ellipse.type = "convex",
             palette = "jco",
             ggtheme = theme_minimal())
```

```{r}
library("cluster")
pam.res <- pam(pres, 6)
# Visualize
fviz_cluster(pam.res)
```




```{r}
library(rworldmap)
pres2wi <- subset(pres2, season == "1")
pres2sp <- subset(pres2, season == "2")
pres2su <- subset(pres2, season == "3")
pres2au <- subset(pres2, season == "4")
map2 <- getMap(resolution = "low") #creates an object called map at low resoultion
plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "pres2wi", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(pres2wi$decimalLongitude, pres2wi$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
points(pres2sp$decimalLongitude, pres2sp$decimalLatitude, col = "blue") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
points(pres2su$decimalLongitude, pres2su$decimalLatitude, col = "green") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
points(pres2au$decimalLongitude, pres2au$decimalLatitude, col = "yellow") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
```

```{r}
map2 <- getMap(resolution = "low") #creates an object called map at low resoultion
plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "winter", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(pres2wi$decimalLongitude, pres2wi$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
```


```{r}
map2 <- getMap(resolution = "low") #creates an object called map at low resoultion
plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "spring", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(pres2sp$decimalLongitude, pres2sp$decimalLatitude, col = "blue") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")

```


```{r}
map2 <- getMap(resolution = "low") #creates an object called map at low resoultion
plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "summer", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(pres2su$decimalLongitude, pres2su$decimalLatitude, col = "green") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
```



```{r}
map2 <- getMap(resolution = "low") #creates an object called map at low resoultion
plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "autumn", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(pres2au$decimalLongitude, pres2au$decimalLatitude, col = "yellow") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
```

```{r}
p98 <- subset(pres2, year == "1998")
p99 <- subset(pres2, year == "1999")
p00 <- subset(pres2, year == "2000")
p01 <- subset(pres2, year == "2001")
p02 <- subset(pres2, year == "2002")
p03 <- subset(pres2, year == "2003")
p04 <- subset(pres2, year == "2004")
p05 <- subset(pres2, year == "2005")
p06 <- subset(pres2, year == "2006")
p07 <- subset(pres2, year == "2007")
p08 <- subset(pres2, year == "2009")
p09 <- subset(pres2, year == "2009")
p10 <- subset(pres2, year == "2010")
p11 <- subset(pres2, year == "2011")
p12 <- subset(pres2, year == "2012")
p13 <- subset(pres2, year == "2013")
p14 <- subset(pres2, year == "2014")
p15 <- subset(pres2, year == "2015")

```


```{r}
map2 <- getMap(resolution = "low") #creates an object called map at low resoultion
plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "1998", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p98$decimalLongitude, p98$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_1998.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "1999", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p99$decimalLongitude, p99$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_1999.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2000", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p00$decimalLongitude, p00$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2000.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2001", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p01$decimalLongitude, p01$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2001.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2002", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p02$decimalLongitude, p02$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2002.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2003", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p03$decimalLongitude, p03$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2003.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2004", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p04$decimalLongitude, p04$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2004.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2005", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p05$decimalLongitude, p05$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2005.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2006", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p06$decimalLongitude, p06$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2006.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2007", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p07$decimalLongitude, p07$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2007.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2008", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p08$decimalLongitude, p08$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2008.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2009", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p09$decimalLongitude, p09$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2009.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2010", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p10$decimalLongitude, p10$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2010.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2011", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p11$decimalLongitude, p11$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2011.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2012", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p12$decimalLongitude, p12$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2012.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2013", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p13$decimalLongitude, p13$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2013.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2014", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p14$decimalLongitude, p14$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2014.png") #this prints a png of the plot
dev.off() #this turns off the print command

plot(map2, xlim = c(-70, -43), ylim =c(38, 70), asp = 1, main = "2015", col = "cornsilk") #the x and y lim are the long-lat bounds of the map
points(p15$decimalLongitude, p15$decimalLatitude, col = "red") #this adds points to the mapet", xlab = "Longitude", ylab = "Latitude")
dev.copy(png, "../data/bio/occurrence_map/p_2015.png") #this prints a png of the plot
dev.off() #this turns off the print command
```



# violin plots

```{r}
#load a test raster

ras <- raster("../output/maxent/predictions/apr/cloglog_st201004000120.asc")
plot(ras)
ras2 <- raster("../output/maxent/predictions/oct/cloglog_st201010000120.asc")
plot(ras2)
rasd <- as.data.frame(ras)
rasd$month <- "4"
rasd2 <- as.data.frame(ras2)
rasd2$month <- "10"
names(rasd)[names(rasd) == "cloglog_st201004000120"] <- "prob"
names(rasd2)[names(rasd2) == "cloglog_st201010000120"] <- "prob"
rasd$month <- as.factor(rasd$month)
rasd2$month <- as.factor(rasd2$month)
rd <- rbind(rasd, rasd2)
rd
p <- ggplot(rd, aes(x=month, y = prob)) + geom_violin(trim=FALSE)
plot(p)


mth <- c("jan", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec")
for (m in 1:length(mth)){
  mon <- mth[m]
  vlst <- list.files(paste0("../output/maxent/predictions/", mon), pattern = "^avg_cloglog.*.asc", full.names = TRUE)
  for (v in 1:length(vlst)){
    ras <- raster(vlst[v])
    rasd <- as.data.frame(ras)
    if (mon == "jan"){
      rasd$month <- "1"
      rnm <- names(ras)
      names(rasd)[names(rasd) == rnm] <- "prob"
      rasd$month <- as.factor(rasd$month)
      rd1 <- rasd
      } else if(mon == "mar"){
        rasd$month <- "3"
        rnm <- names(ras)
        names(rasd)[names(rasd) == rnm] <- "prob"
        rasd$month <- as.factor(rasd$month)
        rd3 <- rasd
      } else if(mon == "apr"){
        rasd$month <- "4"
        rnm <- names(ras)
        names(rasd)[names(rasd) == rnm] <- "prob"
        rasd$month <- as.factor(rasd$month)
        rd4 <- rasd
      } else if(mon == "may"){
        rasd$month <- "5"
        rnm <- names(ras)
        names(rasd)[names(rasd) == rnm] <- "prob"
        rasd$month <- as.factor(rasd$month)
        rd5 <- rasd
      } else if(mon == "jun"){
        rasd$month <- "6"
        rnm <- names(ras)
        names(rasd)[names(rasd) == rnm] <- "prob"
        rasd$month <- as.factor(rasd$month)
        rd6 <- rasd
      } else if(mon == "jul"){
        rasd$month <- "7"
        rnm <- names(ras)
        names(rasd)[names(rasd) == rnm] <- "prob"
        rasd$month <- as.factor(rasd$month)
        rd7 <- rasd
      } else if(mon == "aug"){
        rasd$month <- "8"
        rnm <- names(ras)
        names(rasd)[names(rasd) == rnm] <- "prob"
        rasd$month <- as.factor(rasd$month)
        rd8 <- rasd
      } else if(mon == "sep"){
        rasd$month <- "9"
        rnm <- names(ras)
        names(rasd)[names(rasd) == rnm] <- "prob"
        rasd$month <- as.factor(rasd$month)
        rd9 <- rasd
      } else if(mon == "oct"){
        rasd$month <- "10"
        rnm <- names(ras)
        names(rasd)[names(rasd) == rnm] <- "prob"
        rasd$month <- as.factor(rasd$month)
        rd10 <- rasd
      } else if(mon == "nov"){
        rasd$month <- "11"
        rnm <- names(ras)
        names(rasd)[names(rasd) == rnm] <- "prob"
        rasd$month <- as.factor(rasd$month)
        rd11 <- rasd
      } else if(mon == "dec"){
        rasd$month <- "12"
        rnm <- names(ras)
        names(rasd)[names(rasd) == rnm] <- "prob"
        rasd$month <- as.factor(rasd$month)
        rd12 <- rasd
      }
   
     
  }


}
  rd <- rbind(rd1, rd3, rd4, rd5, rd6, rd7, rd8, rd9, rd10, rd11, rd12)
    #rd <- as.data.frame(rd)
    #rd$month <- as.factor(rd$month)
p <- ggplot(rd, aes(x=month, y = prob)) + geom_violin(trim=FALSE)
plot(p)






```





. For key predictor variables, can you plot probability of occurrence (y-axis) vs predictor (x-axis). I would like to see raw data which will be 1 for presence and 0 for background and then overlay the model predicted relationships on top of the raw data for the two models (full year, month). Functiona "abline (model name)" plots the model prediction for many models in R - not sure this will work for MaxEnt. This will show how the predictions vary for the different variables - perhaps it is just one driving the differences. Does this make sense?


first need to add the same depth indicator as used in the file names

```{r}
completeFun <- function(data, desiredCols) {
  completeVec <- complete.cases(data[, desiredCols])
  return(data[completeVec, ])
}

data_aea <- read.csv("../output/bio/presab_nafo_yr.csv", header = TRUE)
data_aea$depthlyr_mod <- NA
data_aea$predicted_alldata <- NA
data_aea <- completeFun(data_aea, "depth_layer")

avgasc_list <- list.files(paste0("../output/maxent/all_data/predictions/july/"), pattern = "^avg_.*.asc", full.names = TRUE) #true means the full path is included
depths <- list()
for (i in 1:length(avgasc_list)){
  ascname <-  str_sub(avgasc_list[i], 48, -5)
  depths[[paste0(i)]] <- ascname
}

for (j in 1:nrow(data_aea)){
  d <- data_aea$depth_layer[j]
  d3 <- str_sub(d, end = 3) #extract first 3 digits 
   for (k in 1:length(depths)){
    l <- depths[[k]]
    l3 <- str_sub(l, end = 3) #extract first 3 digits
    if (d3 == l3){
      data_aea$depthlyr_mod[j] <- l
    }
  }
}
data_aea <- completeFun(data_aea, "depthlyr_mod")


```


```{r}
#mth <- c("1", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12")
#mthn <- c("jan", "may", "apr", "may", "jun", "july", "aug", "sep", "oct", "nov","dec")
aea <- raster("../output/env/aea.tif") 



#for (m in 1:length(mth)){
#mont <- mth[m]
mont <- 11
data_aeaX <- subset(data_aea, month == mont)
xy <- data_aeaX[ ,c(19,20)] # This is to tell R where the coordinates are (in column 18 and 19). Note that the column order needs to be longitude, latitude
data_aea_sp <- SpatialPointsDataFrame(coords = xy, data = data_aeaX, proj4string = CRS("+proj=aea +lat_1=50 +lat_2=70 +lat_0=40 +lon_0=-60 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs")) # The CRS is used here is for the albers equal area projection.
avgasc_list <- list.files(paste0("../output/maxent/all_data/predictions/nov/"), pattern = "^avg_.*.asc", full.names = TRUE) #true means the full path is included
for (j in 1:nrow(data_aea_sp)) { 
for (i in 1:length(avgasc_list)) {  
 de <- data_aea_sp$depthlyr_mod[j]  # a variable for the observation depth layer
  mth <- (data_aea_sp$month[j])  # a variable for the observation month
  rasdep <- str_sub(avgasc_list[i], 47, -5)
       if (mth == mont & rasdep == de){
          temp_brick <- raster(avgasc_list[i])
        crs(temp_brick) <- aea@crs 
              data_aea_sp$predicted[j] <- extract(x=temp_brick, y = data_aea_sp[j, ]) 
              
              }
          }
}

#}
              data_aea1 <- as.data.frame(data_aea_sp)

write.csv(data_aea1, "../output/maxent/all_data/pred_file_nov.csv", row.names = FALSE)
 #}
  
 # data_aea1 <- as.data.frame(data_aea_sp)

```


```{r}

aea <- raster("../output/env/aea.tif") 



#for (m in 1:length(mth)){
#mont <- mth[m]
mont <- 11
data_aeaX <- read.csv("../output/maxent/all_data/pred_file_nov.csv", header = TRUE)
data_aeaX$mthpred <- NA
xy <- data_aeaX[ ,c(19,20)] # This is to tell R where the coordinates are (in column 18 and 19). Note that the column order needs to be longitude, latitude
data_aea_sp <- SpatialPointsDataFrame(coords = xy, data = data_aeaX, proj4string = CRS("+proj=aea +lat_1=50 +lat_2=70 +lat_0=40 +lon_0=-60 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs")) # The CRS is used here is for the albers equal area projection.
avgasc_list <- list.files(paste0("../output/maxent/predictions/nov/"), pattern = "^avg_.*.asc", full.names = TRUE) #true means the full path is included
for (j in 1:nrow(data_aea_sp)) { 
for (i in 1:length(avgasc_list)) {  
 de <- data_aea_sp$depthlyr_mod[j]  # a variable for the observation depth layer
  mth <- (data_aea_sp$month[j])  # a variable for the observation month
  rasdep <- str_sub(avgasc_list[i], 46, -5)
       if (mth == mont & rasdep == de){
          temp_brick <- raster(avgasc_list[i])
        crs(temp_brick) <- aea@crs 
              data_aea_sp$mthpred[j] <- extract(x=temp_brick, y = data_aea_sp[j, ]) 
              
              }
          }
}

#}
              data_aea1 <- as.data.frame(data_aea_sp)
              write.csv(data_aea1, "../output/maxent/all_data/pred_file_nov.csv", row.names = FALSE)


```


```{r}
predjan <- read.csv("../output/maxent/all_data/testforslr_jan.csv", header = TRUE)
predjanpr <- subset(predjan, occurrence == 1)
plot(predjanpr$temp_depth, predjanpr$predicted)
predjanbk <- subset(predjan, occurrence == 0)
plot(predjanbk$temp_depth, predjanbk$predicted)
```

```{r}
mod <- readRDS(file = "../output/maxent/all_data/maxmod.rds", refhook = NULL)
px <- response(mod@models[[4]])
```

#get all probabiltiy values for a period of time and find the upper 20%


for july with all data
```{r}
clogasc_list <- list.files(paste0("../output/maxent/all_data/predictions/july/"), pattern = "^avg_.*.asc", full.names = TRUE) # first list the files containing the data
a <- stack(clogasc_list) #stack the files
b <- getValues(a) # create a matrix of the values 
c <- as.vector(b) #make into vector
d <- na.omit(c) #remove all na values
d <- sort(d, decreasing = TRUE) # order from high to low
drow <- length(d) # how many values are there
dr20 <- (drow*20)/100  # calculate which value is the upper 20%
d20 <- d[dr20] # 0.149577....
dmaxv <- max(d) #0.998087
dm20 <- (dmaxv*80)/100 # calculate the 20% of 0.998097...  = 0.798477....


#binary threshold function d20
bind20 <- function(x){
  ifelse(x >= d20, 1,
  ifelse(x < d20, 0, NA)) 
}

#binary threshold function dm20
bindm20 <- function(x){
  ifelse(x >= dm20, 1,
  ifelse(x < dm20, 0, NA)) 
}

for (cum in 1:length(clogasc_list)){
  cumascdep <- str_sub(clogasc_list[cum], start = 47, end = -5) #selects the depth from the file name
  cumasc <- raster(clogasc_list[cum])
  ascname <- names(cumasc)
  cum_d20 <- calc(cumasc, fun = bind20)
  cum_dm20 <- calc(cumasc, fun = bindm20)
  writeRaster(cum_d20, paste0("../output/maxent/slr_analysis/july_alldata/july_alldata_d20_", ascname, ".asc"), overwrite = TRUE)
  writeRaster(cum_dm20, paste0("../output/maxent/slr_analysis/july_alldata/july_alldata_dm20_", ascname, ".asc"), overwrite = TRUE)
  }



binaryclog_list <- list.files(paste0("../output/maxent/slr_analysis/july_alldata"), pattern = "^july_alldata_d20_.*.asc", full.names = TRUE)
binstack <- stack(binaryclog_list)
stacksum <- sum(binstack, na.rm = TRUE)
writeRaster(stacksum, "../output/maxent/slr_analysis/july_alldata/d20_2d.asc", overwrite=TRUE)
plot(stacksum, png("../output/maxent/slr_analysis/july_alldata/d20_2d.png"))
dev.off()
binaryclog_list <- list.files(paste0("../output/maxent/slr_analysis/july_alldata"), pattern = "^july_alldata_dm20_.*.asc", full.names = TRUE)
binstack <- stack(binaryclog_list)
stacksum <- sum(binstack, na.rm = TRUE)
writeRaster(stacksum, "../output/maxent/slr_analysis/july_alldata/dm20_2d.asc", overwrite=TRUE)
plot(stacksum, png("../output/maxent/slr_analysis/july_alldata/dm20_2d.png"))
dev.off()


#make map

aea <- raster("../output/env/aea.tif") #the correct CRS
s <- shapefile("../data/env/landp/landpro.shp") #made in arcgis
apr <- aea@crs
#brk <- seq(0.1, 1, 0.1) #for legend
redtrans <- rgb(218, 215, 216, 90, maxColorValue=255) 
outsidemcp <- shapefile("../data/env/landp/mcpout.shp") #made in arcgis
presback <- read.csv("../output/bio/presab_nafo_yr.csv", header = TRUE)
pronly <- subset(presback, occurrence == 1)
prjul <- subset(pronly, month == 7)
#prjan <- subset(pronly, month == 1)


  pras <- raster("../output/maxent/slr_analysis/july_alldata/d20_2d.asc")
  crs(pras) <- apr
  ascname <- names(pras)
  pras[pras >0] <- 1
  #lp <- plot(pras, col=rev(colorRampPalette(brewer.pal(10, "Spectral"))(10)), axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(pras, axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(outsidemcp,  col = redtrans, border = redtrans, add = TRUE)
  lp <- plot(s, col = "#474646", border = "#474646", add = TRUE)
  lp <- points(prjul$longitude_meters, prjul$latitude_meters, add = TRUE, pch=19, cex = 0.5, col = "red")
  print(lp)
  dev.copy(png, ("../output/maxent/slr_analysis/july_alldata/d20_2d.png"), width = 1920,height = 1080)
  dev.off() # stops automatic saving of the plot to a png))
  
  pras <- raster("../output/maxent/slr_analysis/july_alldata/dm20_2d.asc")
  crs(pras) <- apr
  ascname <- names(pras)
  pras[pras >0] <- 1
  #lp <- plot(pras, col=rev(colorRampPalette(brewer.pal(10, "Spectral"))(10)), axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(pras, axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(outsidemcp,  col = redtrans, border = redtrans, add = TRUE)
  lp <- plot(s, col = "#474646", border = "#474646", add = TRUE)
  lp <- points(prjul$longitude_meters, prjul$latitude_meters, add = TRUE, pch=19, cex = 0.5, col = "red")
  print(lp)
  dev.copy(png, ("../output/maxent/slr_analysis/july_alldata/dm20_2d.png"), width = 1920,height = 1080)
  dev.off() # stops automatic saving of the plot to a png))

```






for july with just july data
```{r}
clogasc_list <- list.files(paste0("../output/maxent/predictions/jul/"), pattern = "^avg_cloglog_.*.asc", full.names = TRUE) # first list the files containing the data
a <- stack(clogasc_list) #stack the files
b <- getValues(a) # create a matrix of the values 
c <- as.vector(b) #make into vector
d <- na.omit(c) #remove all na values
d <- sort(d, decreasing = TRUE) # order from high to low
drow <- length(d) # how many values are there
dr20 <- (drow*20)/100  # calculate which value is the upper 20%
d20 <- d[dr20] # 0.083319....
dmaxv <- max(d) #0.885157....
dm20 <- (dmaxv*80)/100 # calculate the 20% of 0.885157....  = 0.70812....



#binary threshold function d20
bind20 <- function(x){
  ifelse(x >= d20, 1,
  ifelse(x < d20, 0, NA)) 
}

#binary threshold function dm20
bindm20 <- function(x){
  ifelse(x >= dm20, 1,
  ifelse(x < dm20, 0, NA)) 
}

for (cum in 1:length(clogasc_list)){
  cumascdep <- str_sub(clogasc_list[cum], start = 46, end = -5) #selects the depth from the file name
  cumasc <- raster(clogasc_list[cum])
  ascname <- names(cumasc)
  cum_d20 <- calc(cumasc, fun = bind20)
  cum_dm20 <- calc(cumasc, fun = bindm20)
  writeRaster(cum_d20, paste0("../output/maxent/slr_analysis/july_alldata/july_monthdata_d20_", ascname, ".asc"), overwrite = TRUE)
  writeRaster(cum_dm20, paste0("../output/maxent/slr_analysis/july_alldata/july_monthdata_dm20_", ascname, ".asc"), overwrite = TRUE)
  }



binaryclog_list <- list.files(paste0("../output/maxent/slr_analysis/july_alldata"), pattern = "^july_monthdata_d20_.*.asc", full.names = TRUE)
binstack <- stack(binaryclog_list)
stacksum <- sum(binstack, na.rm = TRUE)
writeRaster(stacksum, "../output/maxent/slr_analysis/july_alldata/d20_2d_month.asc", overwrite=TRUE)
plot(stacksum, png("../output/maxent/slr_analysis/july_alldata/d20_2d_month.png"))
dev.off()
binaryclog_list <- list.files(paste0("../output/maxent/slr_analysis/july_alldata"), pattern = "^july_monthdata_dm20_.*.asc", full.names = TRUE)
binstack <- stack(binaryclog_list)
stacksum <- sum(binstack, na.rm = TRUE)
writeRaster(stacksum, "../output/maxent/slr_analysis/july_alldata/dm20_2d_month.asc", overwrite=TRUE)
plot(stacksum, png("../output/maxent/slr_analysis/july_alldata/dm20_2d_month.png"))
dev.off()


#make map

aea <- raster("../output/env/aea.tif") #the correct CRS
s <- shapefile("../data/env/landp/landpro.shp") #made in arcgis
apr <- aea@crs
#brk <- seq(0.1, 1, 0.1) #for legend
redtrans <- rgb(218, 215, 216, 90, maxColorValue=255) 
outsidemcp <- shapefile("../data/env/landp/mcpout.shp") #made in arcgis
presback <- read.csv("../output/bio/presab_nafo_yr.csv", header = TRUE)
pronly <- subset(presback, occurrence == 1)
prjul <- subset(pronly, month == 7)
#prjan <- subset(pronly, month == 1)


  pras <- raster("../output/maxent/slr_analysis/july_alldata/d20_2d_month.asc")
  crs(pras) <- apr
  ascname <- names(pras)
  pras[pras >0] <- 1
  #lp <- plot(pras, col=rev(colorRampPalette(brewer.pal(10, "Spectral"))(10)), axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(pras, axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(outsidemcp,  col = redtrans, border = redtrans, add = TRUE)
  lp <- plot(s, col = "#474646", border = "#474646", add = TRUE)
  lp <- points(prjul$longitude_meters, prjul$latitude_meters, add = TRUE, pch=19, cex = 0.5, col = "red")
  print(lp)
  dev.copy(png, ("../output/maxent/slr_analysis/july_alldata/d20_2d_month.png"), width = 1920,height = 1080)
  dev.off() # stops automatic saving of the plot to a png))
  
  pras <- raster("../output/maxent/slr_analysis/july_alldata/dm20_2d_month.asc")
  crs(pras) <- apr
  ascname <- names(pras)
  pras[pras >0] <- 1
  #lp <- plot(pras, col=rev(colorRampPalette(brewer.pal(10, "Spectral"))(10)), axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(pras, axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(outsidemcp,  col = redtrans, border = redtrans, add = TRUE)
  lp <- plot(s, col = "#474646", border = "#474646", add = TRUE)
  lp <- points(prjul$longitude_meters, prjul$latitude_meters, add = TRUE, pch=19, cex = 0.5, col = "red")
  print(lp)
  dev.copy(png, ("../output/maxent/slr_analysis/july_alldata/dm20_2d_month.png"), width = 1920,height = 1080)
  dev.off() # stops automatic saving of the plot to a png))
```

for jan with all data
```{r}
clogasc_list <- list.files(paste0("../output/maxent/all_data/predictions/jan/"), pattern = "^avg_.*.asc", full.names = TRUE) # first list the files containing the data
a <- stack(clogasc_list) #stack the files
b <- getValues(a) # create a matrix of the values 
c <- as.vector(b) #make into vector
d <- na.omit(c) #remove all na values
d <- sort(d, decreasing = TRUE) # order from high to low
drow <- length(d) # how many values are there
dr20 <- (drow*20)/100  # calculate which value is the upper 20%
d20 <- d[dr20] # 0.08307....
dmaxv <- max(d) #0.996738...
dm20 <- (dmaxv*80)/100 # calculate the 20% of 0.996738...  = 0.7973906....


#binary threshold function d20
bind20 <- function(x){
  ifelse(x >= d20, 1,
  ifelse(x < d20, 0, NA)) 
}

#binary threshold function dm20
bindm20 <- function(x){
  ifelse(x >= dm20, 1,
  ifelse(x < dm20, 0, NA)) 
}

for (cum in 1:length(clogasc_list)){
  cumascdep <- str_sub(clogasc_list[cum], start = 47, end = -5) #selects the depth from the file name
  cumasc <- raster(clogasc_list[cum])
  ascname <- names(cumasc)
  cum_d20 <- calc(cumasc, fun = bind20)
  cum_dm20 <- calc(cumasc, fun = bindm20)
  writeRaster(cum_d20, paste0("../output/maxent/slr_analysis/jan_alldata/jan_alldata_d20_", ascname, ".asc"), overwrite = TRUE)
  writeRaster(cum_dm20, paste0("../output/maxent/slr_analysis/jan_alldata/jan_alldata_dm20_", ascname, ".asc"), overwrite = TRUE)
  }


binaryclog_list <- list.files(paste0("../output/maxent/slr_analysis/jan_alldata"), pattern = "^jan_alldata_d20_.*.asc", full.names = TRUE)
binstack <- stack(binaryclog_list)
stacksum <- sum(binstack, na.rm = TRUE)
writeRaster(stacksum, "../output/maxent/slr_analysis/jan_alldata/d20_2d.asc", overwrite=TRUE)
plot(stacksum, png("../output/maxent/slr_analysis/jan_alldata/d20_2d.png"))
dev.off()
binaryclog_list <- list.files(paste0("../output/maxent/slr_analysis/jan_alldata"), pattern = "^jan_alldata_dm20_.*.asc", full.names = TRUE)
binstack <- stack(binaryclog_list)
stacksum <- sum(binstack, na.rm = TRUE)
writeRaster(stacksum, "../output/maxent/slr_analysis/jan_alldata/dm20_2d.asc", overwrite=TRUE)
plot(stacksum, png("../output/maxent/slr_analysis/jan_alldata/dm20_2d.png"))
dev.off()


#make map

aea <- raster("../output/env/aea.tif") #the correct CRS
s <- shapefile("../data/env/landp/landpro.shp") #made in arcgis
apr <- aea@crs
#brk <- seq(0.1, 1, 0.1) #for legend
redtrans <- rgb(218, 215, 216, 90, maxColorValue=255) 
outsidemcp <- shapefile("../data/env/landp/mcpout.shp") #made in arcgis
presback <- read.csv("../output/bio/presab_nafo_yr.csv", header = TRUE)
pronly <- subset(presback, occurrence == 1)
#prjul <- subset(pronly, month == 7)
prjan <- subset(pronly, month == 1)


  pras <- raster("../output/maxent/slr_analysis/jan_alldata/d20_2d.asc")
  crs(pras) <- apr
  ascname <- names(pras)
  pras[pras >0] <- 1
  #lp <- plot(pras, col=rev(colorRampPalette(brewer.pal(10, "Spectral"))(10)), axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(pras, axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(outsidemcp,  col = redtrans, border = redtrans, add = TRUE)
  lp <- plot(s, col = "#474646", border = "#474646", add = TRUE)
  lp <- points(prjan$longitude_meters, prjan$latitude_meters, add = TRUE, pch=19, cex = 0.5, col = "red")
  print(lp)
  dev.copy(png, ("../output/maxent/slr_analysis/jan_alldata/d20_2d.png"), width = 1920,height = 1080)
  dev.off() # stops automatic saving of the plot to a png))
  
  pras <- raster("../output/maxent/slr_analysis/jan_alldata/dm20_2d.asc")
  crs(pras) <- apr
  ascname <- names(pras)
  pras[pras >0] <- 1
  #lp <- plot(pras, col=rev(colorRampPalette(brewer.pal(10, "Spectral"))(10)), axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(pras, axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(outsidemcp,  col = redtrans, border = redtrans, add = TRUE)
  lp <- plot(s, col = "#474646", border = "#474646", add = TRUE)
  lp <- points(prjan$longitude_meters, prjan$latitude_meters, add = TRUE, pch=19, cex = 0.5, col = "red")
  print(lp)
  dev.copy(png, ("../output/maxent/slr_analysis/jan_alldata/dm20_2d.png"), width = 1920,height = 1080)
  dev.off() # stops automatic saving of the plot to a png))

```

for jan with just jan data
```{r}
clogasc_list <- list.files(paste0("../output/maxent/predictions/jan/"), pattern = "^avg_cloglog_.*.asc", full.names = TRUE) # first list the files containing the data
a <- stack(clogasc_list) #stack the files
b <- getValues(a) # create a matrix of the values 
c <- as.vector(b) #make into vector
d <- na.omit(c) #remove all na values
d <- sort(d, decreasing = TRUE) # order from high to low
drow <- length(d) # how many values are there
dr20 <- (drow*20)/100  # calculate which value is the upper 20%
d20 <- d[dr20] # 0.01165....
dmaxv <- max(d) #0.73946....
dm20 <- (dmaxv*80)/100 # calculate the 20% of 0.73946....  = 0.591569....


#binary threshold function d20
bind20 <- function(x){
  ifelse(x >= d20, 1,
  ifelse(x < d20, 0, NA)) 
}

#binary threshold function dm20
bindm20 <- function(x){
  ifelse(x >= dm20, 1,
  ifelse(x < dm20, 0, NA)) 
}

for (cum in 1:length(clogasc_list)){
  cumascdep <- str_sub(clogasc_list[cum], start = 46, end = -5) #selects the depth from the file name
  cumasc <- raster(clogasc_list[cum])
  ascname <- names(cumasc)
  cum_d20 <- calc(cumasc, fun = bind20)
  cum_dm20 <- calc(cumasc, fun = bindm20)
  writeRaster(cum_d20, paste0("../output/maxent/slr_analysis/jan_alldata/jan_monthdata_d20_", ascname, ".asc"), overwrite = TRUE)
  writeRaster(cum_dm20, paste0("../output/maxent/slr_analysis/jan_alldata/jan_monthdata_dm20_", ascname, ".asc"), overwrite = TRUE)
  }



binaryclog_list <- list.files(paste0("../output/maxent/slr_analysis/jan_alldata"), pattern = "^jan_monthdata_d20_.*.asc", full.names = TRUE)
binstack <- stack(binaryclog_list)
stacksum <- sum(binstack, na.rm = TRUE)
writeRaster(stacksum, "../output/maxent/slr_analysis/jan_alldata/d20_2d_month.asc", overwrite=TRUE)
plot(stacksum, png("../output/maxent/slr_analysis/jan_alldata/d20_2d_month.png"))
dev.off()
binaryclog_list <- list.files(paste0("../output/maxent/slr_analysis/jan_alldata"), pattern = "^jan_monthdata_dm20_.*.asc", full.names = TRUE)
binstack <- stack(binaryclog_list)
stacksum <- sum(binstack, na.rm = TRUE)
writeRaster(stacksum, "../output/maxent/slr_analysis/jan_alldata/dm20_2d_month.asc", overwrite=TRUE)
plot(stacksum, png("../output/maxent/slr_analysis/jan_alldata/dm20_2d_month.png"))
dev.off()


#make map

aea <- raster("../output/env/aea.tif") #the correct CRS
s <- shapefile("../data/env/landp/landpro.shp") #made in arcgis
apr <- aea@crs
#brk <- seq(0.1, 1, 0.1) #for legend
redtrans <- rgb(218, 215, 216, 90, maxColorValue=255) 
outsidemcp <- shapefile("../data/env/landp/mcpout.shp") #made in arcgis
presback <- read.csv("../output/bio/presab_nafo_yr.csv", header = TRUE)
pronly <- subset(presback, occurrence == 1)
prjul <- subset(pronly, month == 7)
#prjan <- subset(pronly, month == 1)


  pras <- raster("../output/maxent/slr_analysis/jan_alldata/d20_2d_month.asc")
  crs(pras) <- apr
  ascname <- names(pras)
  pras[pras >0] <- 1
  #lp <- plot(pras, col=rev(colorRampPalette(brewer.pal(10, "Spectral"))(10)), axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(pras, axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(outsidemcp,  col = redtrans, border = redtrans, add = TRUE)
  lp <- plot(s, col = "#474646", border = "#474646", add = TRUE)
  lp <- points(prjan$longitude_meters, prjan$latitude_meters, add = TRUE, pch=19, cex = 0.5, col = "red")
  print(lp)
  dev.copy(png, ("../output/maxent/slr_analysis/jan_alldata/d20_2d_month.png"), width = 1920,height = 1080)
  dev.off() # stops automatic saving of the plot to a png))
  
  pras <- raster("../output/maxent/slr_analysis/jan_alldata/dm20_2d_month.asc")
  crs(pras) <- apr
  ascname <- names(pras)
  pras[pras >0] <- 1
  #lp <- plot(pras, col=rev(colorRampPalette(brewer.pal(10, "Spectral"))(10)), axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(pras, axes = FALSE, box = FALSE, legend = FALSE)
  lp <- plot(outsidemcp,  col = redtrans, border = redtrans, add = TRUE)
  lp <- plot(s, col = "#474646", border = "#474646", add = TRUE)
  lp <- points(prjan$longitude_meters, prjan$latitude_meters, add = TRUE, pch=19, cex = 0.5, col = "red")
  print(lp)
  dev.copy(png, ("../output/maxent/slr_analysis/jan_alldata/dm20_2d_month.png"), width = 1920,height = 1080)
  dev.off() # stops automatic saving of the plot to a png))
```




```{r}

mont <- 
data_aeaX <- read.csv("../output/maxent/all_data/testforslr_jan.csv", header = TRUE)
data_aeaX$predicted_mthdata <- NA

xy <- data_aeaX[ ,c(19,20)] # This is to tell R where the coordinates are (in column 18 and 19). Note that the column order needs to be longitude, latitude
data_aea_sp <- SpatialPointsDataFrame(coords = xy, data = data_aeaX, proj4string = CRS("+proj=aea +lat_1=50 +lat_2=70 +lat_0=40 +lon_0=-60 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs")) # The CRS is used here is for the albers equal area projection.
avgasc_list <- list.files(paste0("../output/maxent/predictions/jan"), pattern = "^avg_.*.asc", full.names = TRUE) #true means the full path is included
for (j in 1:nrow(data_aea_sp)) { 
for (i in 1:length(avgasc_list)) {  
 de <- data_aea_sp$depthlyr_mod[j]  # a variable for the observation depth layer
  rasdep <- str_sub(avgasc_list[i], 46, -5)
       if (rasdep == de){
          temp_brick <- raster(avgasc_list[i])
        crs(temp_brick) <- aea@crs 
              data_aea_sp$predicted_mthdata[j] <- extract(x=temp_brick, y = data_aea_sp[j, ]) 
              
              }
          }
}

           data_aea1 <- as.data.frame(data_aea_sp)

write.csv(data_aea1, "../output/maxent/all_data/predictions_jan.csv", row.names = FALSE)
 #}
  
```



#code to create benthic layers

```{r}
aea <- raster("../output/env/aea.tif") #the correct CRS
benlst <- list.files("../data/env/ascii/benthic_layers/template", pattern = ".*.asc", full.names = TRUE)
apr <- aea@crs



for (pred in 1:length(benlst)){
  pras <- raster(benlst[pred])
  crs(pras) <- apr
  ascname <- names(pras)
  depth <-  (sapply(strsplit(ascname, "_"), "[[", 4)) # extracting the third part of the netcdf (inc.nc)
  pras[pras >0] <- 0
  pras[is.na(pras)] <- 1
  writeRaster(pras, paste0("../data/env/ascii/benthic_layers/done/benthic_", depth, ".asc"), overwrite = TRUE)

}

#just check it works
benlst <- list.files("../data/env/ascii/benthic_layers/done", pattern = ".*.asc", full.names = TRUE)


for (pred in 1:length(benlst)){
  pras <- raster(benlst[pred])
  plot(pras)
}


```

```{r}
predjan <- read.csv("../output/maxent/all_data/predictions_jan.csv", header = TRUE)
plot(predjan$occurrence, predjan$predicted_mthdata)
plot(predjan$occurrence, predjan$predicted_alldata)
```

```{r}
predjul <- read.csv("../output/maxent/all_data/predictions_jul.csv", header = TRUE)
plot(predjul$occurrence, predjul$predicted_mthdata)
plot(predjul$occurrence, predjul$predicted_alldata)
```


```{r}
predjan <- read.csv("../output/maxent/all_data/predictions_jan.csv", header = TRUE)

completeFun <- function(data, desiredCols) {
  completeVec <- complete.cases(data[, desiredCols])
  return(data[completeVec, ])
}


predjan <- completeFun(predjan, "predicted_mthdata")
predjanoc <- subset(predjan, occurrence == 1)
predjanbk <- subset(predjan, occurrence == 0)
noc <- nrow(predjanoc)
nbk <- nrow(predjanbk)
janmth5plusoc <- sum(predjanoc$predicted_mthdata > 0.5)
janmth5plusbk <- sum(predjanoc$predicted_mthdata > 0.5)
janmthpp <- (janmth5plusoc/noc)*100
janmthbkp <- (janmth5plusbk/nbk)*100

janall5plusoc <- sum(predjanoc$predicted_alldata > 0.5)
janall5plusbk <- sum(predjanoc$predicted_alldata > 0.5)
janallpp <- (janall5plusoc/noc)*100
janallbkp <- (janall5plusbk/nbk)*100
```

```{r}
hist(predjanoc$predicted_mthdata)
hist(predjanoc$predicted_alldata)
hist(predjanbk$predicted_mthdata)
hist(predjanbk$predicted_alldata)
```



```{r}
predjul <- read.csv("../output/maxent/all_data/predictions_jul.csv", header = TRUE)

completeFun <- function(data, desiredCols) {
  completeVec <- complete.cases(data[, desiredCols])
  return(data[completeVec, ])
}


predjul <- completeFun(predjul, "predicted_mthdata")
predjuloc <- subset(predjul, occurrence == 1)
predjulbk <- subset(predjul, occurrence == 0)
noc <- nrow(predjuloc)
nbk <- nrow(predjulbk)

julmth5plusoc <- sum(predjuloc$predicted_mthdata > 0.5)
julmth5plusbk <- sum(predjuloc$predicted_mthdata > 0.5)
julmthpp <- (julmth5plusoc/noc)*100
julmthbkp <- (julmth5plusbk/nbk)*100

julall5plusoc <- subset(predjuloc, predicted_alldata > 0.5)
julall5plusoc <- nrow(julall5plusoc)
julall5plusbk <- subset(predjulbk, predicted_alldata > 0.5)
julall5plusbk <- nrow(julall5plusbk)
julallpp <- (julall5plusoc/noc)*100
julallbkp <- (julall5plusbk/nbk)*100
```


```{r}
hist(predjuloc$predicted_mthdata)
hist(predjuloc$predicted_alldata)
hist(predjulbk$predicted_mthdata)
hist(predjulbk$predicted_alldata)
```


